# =============================================================================
# AWS Lambda 関数：IoT データ処理
# =============================================================================
# 機能：Mosquittoから転送されたMQTTメッセージをJSONパースし、処理実行
# 今後：MySQLへのデータベースINSERT処理を追加予定

# JSON データのシリアライズ・デシリアライズ
import json

# =============================================================================
# Lambda ハンドラー関数
# =============================================================================
# パラメータ：
#   event    - AWS Lambda イベント（MQTT メッセージペイロードが含まれる）
#   context  - Lambda実行環境・リクエストメタデータ（未使用）
# 戻り値：処理結果をJSON形式で返却

def lambda_handler(event, context):
    # Lambda イベントをJSON形式でコンソール出力（デバッグ用）
    print(f"Received MQTT: {json.dumps(event)}")
    
    # ================================
    # 今後実装予定：データベース処理
    # ================================
    # 本来はここでMySQLにデータINSERTする処理を実装
    # 実装例：pymysqlなどのライブラリを使ってDB_HOSTへ接続し、
    #        MQTTペイロードの温度・ステータス等をレコード化して保存
    
    # 処理完了状態を返却
    return {"status": "success"}